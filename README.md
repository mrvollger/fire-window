# fire-window

Generate actuation plots from fibertools pileup files with strand-aware coordinate handling.

## Description

`fire-window` creates publication-quality ribbon plots showing FIRE (Fiber-seq Inferred Regulatory Elements) actuation levels across genomic regions. The tool reads tabix-indexed pileup files generated by fibertools and produces centered, multi-track visualizations with proper strand correction.

## Install

Make sure you have [pixi](https://pixi.dev/) installed.

Add the `bin/` directory to your PATH to use `fire-window` from anywhere:

```bash
export PATH="/path/to/fire-window/bin:$PATH"
```

Or run directly using the path:

```bash
/path/to/repo/bin/fire-window manifest.bed -o output.pdf
```

## Usage

```bash
fire-window manifest.bed -o output.pdf [options]
```

### Arguments

- `manifest.bed` - Tab-separated manifest file with required columns:
  - `#chrom` - chromosome/contig name
  - `start` - region start position (0-based)
  - `end` - region end position
  - `center` - centered position for plotting
  - `pileup` - path to tabix-indexed fibertools pileup BED file
  - `strand` - (optional) strand orientation (`+` or `-`); defaults to `+`

### Options

- `-o, --output` - Output PDF file path (required)
- `-t, --height-per-track` - Height per track in inches (default: 1)
- `-w, --width` - Figure width in inches (default: 8)
- `-c, --color` - Color for the ribbon plot (default: darkred)
- `-b, --highlight-bed` - Optional BED file with regions to highlight (3-column: chrom, start, end)
- `--highlight-color` - Color for highlighted regions (default: darkorange)

### Example

Basic usage:

```bash
fire-window regions.bed -o actuation_plot.pdf -t 1.5 -w 10 -c "#8B0000"
```

With highlighted regions:

```bash
fire-window regions.bed -o actuation_plot.pdf -b highlights.bed -c "#8B0000"
```

## Output

The tool generates a PDF with:

- FIRE actuation levels (0-100%) shown as colored ribbon plots
- Optional highlighted regions shown as semi-transparent orange rectangles
- Vertical dashed line marking the alignment center
- Horizontal blue line indicating the region boundaries
- Separate facets for each region in the manifest

## Development

Format R code:

```bash
pixi run format
```
